!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputDirection={x:0,y:-1}}var t,i,o;return t=e,(i=[{key:"getInputDirection",value:function(){var e=this;return document.addEventListener("keydown",(function(t){switch(t.keyCode){case 37:if(0!==e.inputDirection.x)break;e.inputDirection={x:-1,y:0};break;case 38:if(0!==e.inputDirection.y)break;e.inputDirection={x:0,y:-1};break;case 39:if(0!==e.inputDirection.x)break;e.inputDirection={x:1,y:0};break;case 40:if(0!==e.inputDirection.y)break;e.inputDirection={x:0,y:1}}})),this.inputDirection}}])&&n(t.prototype,i),o&&n(t,o),e}();function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.frameIndex=0;var o={image:[new Image,new Image],width:11,height:11};o.image[0].src="./assets/fireball_0.png",o.image[1].src="./assets/fireball_1.png",this.projectile={sprite:o},this.projectile.position={x:t,y:i},this.projectile.hitbox={topLeft:this.projectile.position,bottomRight:{x:this.projectile.position.x+11,y:this.projectile.position.y+11}},this.projectile.vector=n}var t,i,n;return t=e,(i=[{key:"update",value:function(){this.projectile.position.x+=11*this.projectile.vector.x,this.projectile.position.y+=11*this.projectile.vector.y,this.projectile.hitbox={topLeft:this.projectile.position,bottomRight:{x:this.projectile.position.x+11,y:this.projectile.position.y+11}},(this.frameIndex=0)?this.frameIndex++:this.frameIndex=0}},{key:"draw",value:function(e){e.drawImage(this.projectile.sprite.image[this.frameIndex],0,0,this.projectile.sprite.width,this.projectile.sprite.height,this.projectile.position.x,this.projectile.position.y,this.projectile.sprite.width,this.projectile.sprite.height)}}])&&a(t.prototype,i),n&&a(t,n),e}();function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){h(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.direction,this.input=new o,this.characterFrameIndex=0,this.alive=!0,this.previousPosition;var t={image:[new Image,new Image,new Image,new Image],width:32,height:48};t.image[0].src="./assets/wizard_f_0.png",t.image[1].src="./assets/wizard_f_1.png",t.image[2].src="./assets/wizard_f_2.png",t.image[3].src="./assets/wizard_f_3.png";var i={image:[new Image,new Image,new Image,new Image],width:32,height:48};i.image[0].src="./assets/knight_f_0.png",i.image[1].src="./assets/knight_f_1.png",i.image[2].src="./assets/knight_f_2.png",i.image[3].src="./assets/knight_f_3.png",this.deathCharacter={image:[new Image,new Image,new Image,new Image],width:18,height:24},this.deathCharacter.image[0].src="./assets/follower-gravestone.png",this.deathCharacter.image[1].src="./assets/follower-gravestone.png",this.deathCharacter.image[2].src="./assets/follower-gravestone.png",this.deathCharacter.image[3].src="./assets/follower-gravestone.png",this.conga=[{sprite:t,position:{x:325,y:325}},{sprite:i,position:{x:325,y:360}},{sprite:t,position:{x:325,y:395}}],this.updateHurtBox()}var t,i,n;return t=e,(i=[{key:"update",value:function(){if(this.alive){this.previousPosition={x:this.conga[2].position.x,y:this.conga[2].position.y},this.direction=this.input.getInputDirection();for(var e=this.conga.length-2;e>=0;e--)this.conga[e+1].position=c({},this.conga[e].position);this.conga[0].position.x+=32*this.direction.x,this.conga[0].position.y+=32*this.direction.y,this.updateHurtBox(),3===this.characterFrameIndex?this.characterFrameIndex=0:this.characterFrameIndex++}}},{key:"draw",value:function(e){var t=this;this.conga.forEach((function(i){e.drawImage(i.sprite.image[t.characterFrameIndex],0,0,i.sprite.width,i.sprite.height,i.position.x,i.position.y,i.sprite.width,i.sprite.height)}))}},{key:"revertMove",value:function(){this.conga[0].position=this.conga[1].position,this.conga[1].position=this.conga[2].position,this.conga[2].position=this.previousPosition}},{key:"updateHurtBox",value:function(){this.conga.forEach((function(e){e.hurtbox={topLeft:{x:e.position.x,y:e.position.y},bottomRight:{x:e.position.x+32,y:e.position.y+48}}}))}},{key:"attack",value:function(e,t,i,n){var o=e-i,a=t-n;return o>a?(a/=Math.abs(o),o/=Math.abs(o)):(o/=Math.abs(a),a/=Math.abs(a)),new r(i,n,{x:o,y:a})}}])&&u(t.prototype,i),n&&u(t,n),e}();function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;p(this,e),this.characterFrameIndex=0;var o={image:[new Image,new Image,new Image,new Image],width:16,height:16};o.image[0].src="./assets/dungeon_tileset/frames/skelet_idle_anim_f0.png",o.image[1].src="./assets/dungeon_tileset/frames/skelet_idle_anim_f1.png",o.image[2].src="./assets/dungeon_tileset/frames/skelet_idle_anim_f2.png",o.image[3].src="./assets/dungeon_tileset/frames/skelet_idle_anim_f3.png",this.enemy={sprite:o},this.enemy.position=this.enemySpawnPoint(t,i),this.enemy.hitbox={topLeft:this.enemy.position,bottomRight:{x:this.enemy.position.x+16,y:this.enemy.position.y+16}},n&&(this.enemy.position={x:1e4,y:1e4})}var t,i,n;return t=e,(i=[{key:"enemySpawnPoint",value:function(e,t){for(var i=Math.floor(634*Math.random()),n=Math.floor(594*Math.random());Math.abs(e-i)<64&&Math.abs(t-n);)i=Math.floor(634*Math.random()),n=Math.floor(594*Math.random());return{x:i,y:n}}},{key:"update",value:function(){3===this.characterFrameIndex?this.characterFrameIndex=0:this.characterFrameIndex++}},{key:"draw",value:function(e){e.drawImage(this.enemy.sprite.image[this.characterFrameIndex],0,0,this.enemy.sprite.width,this.enemy.sprite.height,this.enemy.position.x,this.enemy.position.y,2*this.enemy.sprite.width,2*this.enemy.sprite.height)}}])&&m(t.prototype,i),n&&m(t,n),e}();function g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.player=new l,this.dungeon=new Image,this.enemies=[],this.attacks=[],this.score=0,this.dungeon.src="./assets/dungeon.png",this.lose=i}var t,i,n;return t=e,(i=[{key:"draw",value:function(){this.ctx.clearRect(0,0,650,650),this.ctx.drawImage(this.dungeon,0,0,650,650),this.player.draw(this.ctx),this.drawAttacks(),this.drawEnemies()}},{key:"update",value:function(){this.player.update(),this.updateEnemies(this.determineDifficulty()),0===this.attacks.length&&this.attackNearestEnemy(this.player.conga[0].position.x,this.player.conga[0].position.y),this.updateAttacks(),this.gameOver()}},{key:"gameOver",value:function(){var e=this;(this.outsideMap()||this.playerCollision())&&(this.player.alive=!1,this.attacks=[],this.player.conga.forEach((function(t){t.sprite=e.player.deathCharacter})),this.playerCollision()||this.player.revertMove(),this.lose(this.score))}},{key:"outsideMap",value:function(){return this.player.conga[0].position.x<0||this.player.conga[0].position.x>613||this.player.conga[0].position.y<0||this.player.conga[0].position.y>549}},{key:"playerCollision",value:function(){for(var e=this.player.conga[0].hurtbox,t=1;t<this.enemies.length;t++){var i=this.enemies[t].enemy.hitbox;if(this.collision(e.topLeft,e.bottomRight,i.topLeft,i.bottomRight))return!0}return!1}},{key:"collision",value:function(e,t,i,n){return!(e.x>n.x||t.x<i.x||e.y>n.y||t.y<i.y)}},{key:"updateEnemies",value:function(e){var t=this;for(0===this.enemies.length&&this.enemies.push(new f(this.player.conga[0].position.x,this.player.conga[0].position.y,!0));this.enemies.length<e;)this.enemies.push(new f(this.player.conga[0].position.x,this.player.conga[0].position.y));this.enemies.forEach((function(e){e.update(t.ctx)}))}},{key:"drawEnemies",value:function(){var e=this;this.enemies.forEach((function(t){t.draw(e.ctx)}))}},{key:"attackNearestEnemy",value:function(e,t){for(var i=0;i<this.enemies.length;i++)if(Math.abs(this.enemies[i].enemy.position.x-e)<100&&Math.abs(this.enemies[i].enemy.position.y-t)<100){var n=this.player.attack(this.enemies[i].enemy.position.x,this.enemies[i].enemy.position.y,e,t);return void this.attacks.push(n)}}},{key:"drawAttacks",value:function(){var e=this;this.attacks.forEach((function(t){t.draw(e.ctx)}))}},{key:"updateAttacks",value:function(){var e=this;this.attacks.forEach((function(t){t.update(),(t.projectile.position.x>650||t.projectile.position.x<0||t.projectile.position.y>610||t.projectile.position.y<0)&&e.attacks.pop();var i=null;e.enemies.forEach((function(n){e.collision(n.enemy.hitbox.topLeft,n.enemy.hitbox.bottomRight,t.projectile.hitbox.topLeft,t.projectile.hitbox.bottomRight)&&(e.attacks.pop(),i=e.enemies.indexOf(n))})),i&&(e.updateScore(),e.enemies.splice(i,1))}))}},{key:"updateScore",value:function(){this.score++,document.getElementById("score").innerHTML=this.score}},{key:"determineDifficulty",value:function(){return Math.floor(this.score/2+2)}}])&&g(t.prototype,i),n&&g(t,n),e}();function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastRenderTime=0,this.updatesPerSecond=8,this.score=0,this.game=new y(t,i)}var t,i,n;return t=e,(i=[{key:"start",value:function(){this.animate()}},{key:"animate",value:function(e){var t=this;window.requestAnimationFrame((function(e){t.animate(e)})),(e-this.lastRenderTime)/1e3<1/this.updatesPerSecond||(this.lastRenderTime=e,this.update(),this.draw())}},{key:"update",value:function(){this.game.update()}},{key:"draw",value:function(){this.game.draw()}}])&&d(t.prototype,i),n&&d(t,n),e}();function b(){document.getElementById("game-over-modal").style.zIndex=0,document.removeEventListener("keydown",b);var e=document.getElementById("game-screen");e&&e.remove();var t=function(){var e=document.createElement("canvas");return e.id="game-screen",e.classList.add("screen"),e.height=610,e.width=650,e}();document.getElementsByClassName("canvas")[0].append(t);var i=document.getElementById("game-screen").getContext("2d"),n=new v(i,w);document.getElementById("start-screen").style.visibility="hidden",n.start()}function w(e){var t=document.getElementById("game-over-modal"),i=document.getElementById("end-score"),n=document.getElementById("high-score");i.innerHTML="Score: ".concat(e),parseInt(localStorage.getItem("highScore"))<e?(localStorage.setItem("highScore",e),n.innerHTML="High Score: ".concat(localStorage.getItem("highScore"))):n.innerHTML="High Score: ".concat(localStorage.getItem("highScore")),t.style.zIndex=11,setTimeout((function(){document.addEventListener("keydown",b)}),500)}document.addEventListener("DOMContentLoaded",(function(){localStorage.getItem("highScore")||localStorage.setItem("highScore",0),document.getElementById("start-screen").style.visibility="visible",setTimeout((function(){document.addEventListener("keydown",b)}),500)}))}]);
//# sourceMappingURL=main.js.map